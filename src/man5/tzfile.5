.TH TZFILE 5
.SH НАЗВАНИЕ
tzfile \- информация о часовом поясе
.SH СИНТАКСИС
.B
#include <tzfile.h>
.SH ОПИСАНИЕ
Файлы с информацией о часовых поясах, которые использует функция
.IR tzset (3),
начинаются с символов "TZif", показывающих, что это файлы с информацией о
часовых поясах, затем располагаются шестнадцать байт, зарезервированных для
будущего использования, за ними располагаются шесть четырёхбайтовых значений
типа
.BR long ,
записанных в ``сетевом'' порядке байт
(старший байт значения записывается первым).
Вот эти значения, по порядку:
.TP
.I tzh_ttisgmtcnt
Количество индикаторов UTC и местных индикаторов, хранящихся в файле.
.TP
.I tzh_ttisstdcnt
Количество индикаторов "времени на часах" (wall-clock time) или
стандартного времени, хранящихся в файле.
.TP
.I tzh_leapcnt
Количество високосных секунд, данные о которых хранятся в файле.
.TP
.I tzh_timecnt
Количество "моментов перевода времени", данные о которых хранятся в файле.
.TP
.I tzh_typecnt
Количество "типов местного времени" , данные о которых хранятся в файле (
должно быть ненулевым).
.TP
.I tzh_charcnt
Количество символов в "строках аббревиатур часовых поясов", хранящихся в файле.
.PP
После этого заголовка следуют
.IR tzh_timecnt ,
четырёхбайтовые значения типа
.BR long ,
отсортированные по возрастанию.
Эти значения записаны в ``сетевом'' порядке байт.
Каждое из них рассматривается как момент перевода времени (в том виде,
как его возвращает функция
.IR time (2)).
Далее следуют 
однобайтовые значения типа
.B "unsigned char"
в количестве
.IR tzh_timecnt ,
каждое из которых показывает, как различные типы ``местного времени'',
описываемые в файле, связаны с моментами перевода времени с теми же индексами.
Эти значения служат в качестве индексов массива структур
.IR ttinfo ,
которые располагаются далее в файле;
эти структуры определены так:
.in +.5i
.sp
.nf
.ta .5i +\w'unsigned int\0\0'u
struct ttinfo {
	long	tt_gmtoff;
	int	tt_isdst;
	unsigned int	tt_abbrind;
};
.in -.5i
.fi
.sp
Каждая структура определена в виде четырёхбайтового значения
.I tt_gmtoff
типа
.B long
в сетевом порядке байт, однобайтового значения
.I tt_isdst
и однобайтового значения
.IR tt_abbrind .
В каждой структуре
.I tt_gmtoff
определяет количество секунд, которые нужно добавить к UTC,
.I tt_isdst
показывает, будет ли 
.I localtime (3)
устанавливать значение
.IR tm_isdst ,
а
.I tt_abbrind
служит в индексом массива символов аббревиатур часовых поясов, которые
располагаются в виде структур(ы)
.I ttinfo
в файле далее.
.PP
Затем следуют пары четырёхбайтовых значений
.IR tzh_leapcnt ,
записанных в сетевом порядке байт;
первое значение каждой пары определяет время
(в формате
.IR time(2)),
когда встретилась високосная секунда;
второе определяет
.I общее
число високосных секунд, которые нужно применить после заданного времени.
Пары значений отсортированы по времени в возрастающем порядке.
.PP
Далее располагаются 
индикаторы стандартного времени или "времени на часах" в количестве
.IR tzh_ttisstdcnt ,
причем каждый занимает один байт.
Они показывают, указаны ли моменты перевода времени, связанные с типами 
местного времени, в стандартном или "времени на часах", 
и применяются, когда файл часовых поясов используется при обработке 
переменных среды, указывающих часовые пояса в стиле POSIX.
.PP
Наконец, идут
индикаторы UTC или местные индикаторы в количестве
.IR tzh_ttisgmtcnt ,
причем каждый занимает один байт;
Они показывают, указаны ли моменты перевода времени, связанные с типами 
местного времени, в местном времени или в UTC,
и применяются, когда файл часовых поясов используется при обработке 
переменных среды, указывающих часовые пояса в стиле POSIX.
.PP
.I Localtime
использует первую структуру
.I ttinfo
со стандартным временем из файла
(или просто первую структуру
.I ttinfo
при отсутствии структуры со стандартным временем),
если
.I tzh_timecnt
равен нулю или аргумент времени меньше, чем первый момент перевода времени, записанный
в файле.
.SH "СМОТРИ ТАКЖЕ"
newctime(3)
.\" @(#)tzfile.5	7.11
.\" This file is in the public domain, so clarified as of
.\" 1996-06-05 by Arthur David Olson (arthur_david_olson@nih.gov).
.SH ПЕРЕВОД
Юрий Козлов <y_kozlov@chat.ru>.
.\" Вычитано и скорректировано by alexm@hsys.msk.ru для проекта
.\" http://alexm.here.ru/manpages-ru/
.\"
.\" man-pages-1.34
.\" Пнд Фев  5 15:29:09 MSK 2001
.\" Linux User Group г. Сергиев Посад http://spslug.sposad.ru/
.\" HomePage                          http://www.chat.ru/~y_kozlov/
